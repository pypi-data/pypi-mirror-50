<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Twilight fiber-flat &#8212; MEGARA Data Reduction Pipeline 0.6.dev1 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.6.dev1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="MEGARA Data Reduction Pipeline 0.6.dev1 documentation" href="../index.html" />
    <link rel="up" title="Calibration Modes" href="index.html" />
    <link rel="next" title="Bad-pixels mask" href="bpm.html" />
    <link rel="prev" title="Fiber-flat" href="fiberflat.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bpm.html" title="Bad-pixels mask"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fiberflat.html" title="Fiber-flat"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MEGARA Data Reduction Pipeline 0.6.dev1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modes.html" >Observing modes</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Calibration Modes</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="twilight-fiber-flat">
<h1>Twilight fiber-flat<a class="headerlink" href="#twilight-fiber-flat" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Mode:</th><td class="field-body">Twilight fiber-flat</td>
</tr>
<tr class="field-even field"><th class="field-name">Usage:</th><td class="field-body">Offline</td>
</tr>
<tr class="field-odd field"><th class="field-name">Key:</th><td class="field-body">MEGARA_TWILIGHT_FLAT_IMAGE</td>
</tr>
<tr class="field-even field"><th class="field-name">Product:</th><td class="field-body"><a class="reference internal" href="../reference/products.html#megaradrp.types.MasterTwilightFlat" title="megaradrp.types.MasterTwilightFlat"><code class="xref py py-class docutils literal"><span class="pre">MasterTwilightFlat</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Recipe:</th><td class="field-body"><a class="reference internal" href="#megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe" title="megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe"><code class="xref py py-class docutils literal"><span class="pre">TwilightFiberFlatRecipe</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Recipe input:</th><td class="field-body"><a class="reference internal" href="#megaradrp.recipes.calibration.twilight.RecipeInput" title="megaradrp.recipes.calibration.twilight.RecipeInput"><code class="xref py py-class docutils literal"><span class="pre">megaradrp.recipes.calibration.twilight.RecipeInput</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Recipe result:</th><td class="field-body"><a class="reference internal" href="#megaradrp.recipes.calibration.twilight.RecipeResult" title="megaradrp.recipes.calibration.twilight.RecipeResult"><code class="xref py py-class docutils literal"><span class="pre">megaradrp.recipes.calibration.twilight.RecipeResult</span></code></a></td>
</tr>
</tbody>
</table>
<p>Depending on the final performance of the ICM (provided by the GTC) at F-C the
twilight fiber-flat mode (proposed in this section) might be offered as
optional to the observer or a must should a proper data reduction be required.
In any case this must be always available as an observing mode.</p>
<p>The twilight fiber-flat observing mode should include the actions required to
calibrate the low-frequency sensitivity variation in the spatial direction of
the detector. In principle, the lamp fiber-flat should suffice to correct the
change in sensitivity along both the spatial (fiber-to-fiber relative
transmission) and the spectral direction of the system. The latter only
combined with flux standard-star observations since the spectral shape of the
ICM lamps is not known with enough accuracy.</p>
<p>The twilight fiber-flat is based on the observation of the blank twilight sky.
This can safely assume to homogeneously illuminate the entire MEGARA field of
view (3.5 arcmin x 3.5 arcmin).</p>
<div class="section" id="requeriments">
<h2>Requeriments<a class="headerlink" href="#requeriments" title="Permalink to this headline">¶</a></h2>
<p>The focal plane should be uniformly illuminated with twilight-sky light. As the
illumination conditions change during twilight, each image set has a different
exposure time. The purpose is to obtain a similar (linear) level of DUs at the
detector (counts) under different illumination conditions.</p>
<p>This mode requires having the focal-plane cover configured (at least one of the
sides should be open), the instrument shutter open, the telescope tracking, to
move the pseudo-slit to that of the instrument mode of choice, to configure the
VPH wheel mechanism in order to select the grating to be used, to move the
focusing mechanism to the position pre-defined for the specific VPH of choice
and to take a series of exposures with different exposure times and to readout
the detector for this series of exposures, being these series the twilight
image set, each with a different exposure time, but with similar level of
counts.</p>
</div>
<div class="section" id="procedure">
<h2>Procedure<a class="headerlink" href="#procedure" title="Permalink to this headline">¶</a></h2>
<p>The &#8220;User&#8221; processes an observing block obtained in the observing mode Twilight
Fiber Flat. This mode includes the required actions to obtain a master
illumination flat field. The master illumination flat field generated is used
in other stages of the data processing.</p>
</div>
<div class="section" id="products">
<h2>Products<a class="headerlink" href="#products" title="Permalink to this headline">¶</a></h2>
<p>Twilight-sky fiber-flat image sets are expected to be obtained as part of the
routine calibration activities performed by the observer since are needed for
processing any scientific-valid data. Therefore, this observing mode should be
considered as part of the &#8220;Daily Calibration Modes&#8221;.</p>
<p>A RSS master illumination flat field, QA flag, a text log file of the
processing and a structured text file containing information about the
processing.</p>
</div>
<div class="section" id="recipe-inputs-and-results">
<h2>Recipe, inputs and results<a class="headerlink" href="#recipe-inputs-and-results" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="megaradrp.recipes.calibration.twilight.RecipeInput">
<em class="property">class </em><code class="descclassname">megaradrp.recipes.calibration.twilight.</code><code class="descname">RecipeInput</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#megaradrp.recipes.calibration.twilight.RecipeInput" title="Permalink to this definition">¶</a></dt>
<dd><p>RecipeInput documentation.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>master_bias</td>
<td>(MasterBias, requirement) Master BIAS image</td>
</tr>
<tr class="row-even"><td>master_bpm</td>
<td>(MasterBPM, requirement, optional) Master Bad Pixel Mask</td>
</tr>
<tr class="row-odd"><td>master_dark</td>
<td>(MasterDark, requirement, optional) Master DARK image</td>
</tr>
<tr class="row-even"><td>master_fiberflat</td>
<td>(MasterFiberFlat, requirement) Master fiber flat calibration</td>
</tr>
<tr class="row-odd"><td>master_slitflat</td>
<td>(MasterSlitFlat, requirement, optional) Master slit flat calibration</td>
</tr>
<tr class="row-even"><td>master_traces</td>
<td>(TraceMap, requirement) Trace information of the Apertures</td>
</tr>
<tr class="row-odd"><td>master_wlcalib</td>
<td>(WavelengthCalibration, requirement) Wavelength calibration table</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="megaradrp.recipes.calibration.twilight.RecipeResult">
<em class="property">class </em><code class="descclassname">megaradrp.recipes.calibration.twilight.</code><code class="descname">RecipeResult</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#megaradrp.recipes.calibration.twilight.RecipeResult" title="Permalink to this definition">¶</a></dt>
<dd><p>RecipeResult documentation.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>master_twilightflat</td>
<td>(MasterTwilightFlat, product)</td>
</tr>
<tr class="row-even"><td>reduced_image</td>
<td>(ProcessedFrame, product)</td>
</tr>
<tr class="row-odd"><td>reduced_rss</td>
<td>(ProcessedRSS, product)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe">
<em class="property">class </em><code class="descclassname">megaradrp.recipes.calibration.twilight.</code><code class="descname">TwilightFiberFlatRecipe</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe" title="Permalink to this definition">¶</a></dt>
<dd><p>Process TWILIGHT_FLAT images and create MASTER_TWILIGHT_FLAT product.</p>
<p>This recipe process a set of continuum flat images obtained in
<strong>Twilight Fiber Flat</strong> mode and returns the master twilight flat product
The recipe also returns the result of processing the input images up to
slitflat correction. and the result RSS of the processing
up to wavelength calibration.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="../reference/products.html#megaradrp.types.MasterTwilightFlat" title="megaradrp.types.MasterTwilightFlat"><code class="xref py py-obj docutils literal"><span class="pre">megaradrp.types.MasterTwilightFlat</span></code></a></dt>
<dd>description of MasterTwilightFlat product</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Images provided in <cite>obresult</cite> are trimmed and corrected from overscan,
bad pixel mask (if <cite>master_bpm</cite> is not None), bias and dark current
(if <cite>master_dark</cite> is not None) and corrected from pixel-to-pixel flat
if <cite>master_slitflat</cite> is not None.
Images thus corrected are the stacked using the median.</p>
<p>The result of the combination is saved as an intermediate result, named
&#8216;reduced_image.fits&#8217;. This combined image is also returned in the field
<cite>reduced_image</cite> of the recipe result.</p>
<p>The apertures in the 2D image are extracted, using the information in
<cite>master_traces</cite> and resampled according to the wavelength calibration in
<cite>master_wlcalib</cite>. Then is divided by the <cite>master_fiberflat</cite>.
The resulting RSS is saved as an intermediate
result named &#8216;reduced_rss.fits&#8217;. This RSS is also returned in the field
<cite>reduced_rss</cite> of the recipe result.</p>
<p>To normalize the <cite>master_twilight_flat</cite>, each fiber is divided by the average
of the 200 central columns. This RSS
image is returned in the field <cite>master_twilightflat</cite> of the recipe result.</p>
<dl class="class">
<dt id="megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.MegaraBaseRecipeInput">
<em class="property">class </em><code class="descname">MegaraBaseRecipeInput</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.MegaraBaseRecipeInput" title="Permalink to this definition">¶</a></dt>
<dd><p>MegaraBaseRecipeInput documentation.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>obresult</td>
<td>(ObservationResultType, requirement) Observation Result</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.MegaraBaseRecipeResult">
<em class="property">class </em><code class="descclassname">TwilightFiberFlatRecipe.</code><code class="descname">MegaraBaseRecipeResult</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.MegaraBaseRecipeResult" title="Permalink to this definition">¶</a></dt>
<dd><p>MegaraBaseRecipeResult documentation.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>qc</td>
<td>(QualityControlProduct, product)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.RecipeInput">
<em class="property">class </em><code class="descclassname">TwilightFiberFlatRecipe.</code><code class="descname">RecipeInput</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.RecipeInput" title="Permalink to this definition">¶</a></dt>
<dd><p>RecipeInput documentation.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>master_bias</td>
<td>(MasterBias, requirement) Master BIAS image</td>
</tr>
<tr class="row-even"><td>master_bpm</td>
<td>(MasterBPM, requirement, optional) Master Bad Pixel Mask</td>
</tr>
<tr class="row-odd"><td>master_dark</td>
<td>(MasterDark, requirement, optional) Master DARK image</td>
</tr>
<tr class="row-even"><td>master_fiberflat</td>
<td>(MasterFiberFlat, requirement) Master fiber flat calibration</td>
</tr>
<tr class="row-odd"><td>master_slitflat</td>
<td>(MasterSlitFlat, requirement, optional) Master slit flat calibration</td>
</tr>
<tr class="row-even"><td>master_traces</td>
<td>(TraceMap, requirement) Trace information of the Apertures</td>
</tr>
<tr class="row-odd"><td>master_wlcalib</td>
<td>(WavelengthCalibration, requirement) Wavelength calibration table</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.RecipeResult">
<em class="property">class </em><code class="descclassname">TwilightFiberFlatRecipe.</code><code class="descname">RecipeResult</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#megaradrp.recipes.calibration.twilight.TwilightFiberFlatRecipe.RecipeResult" title="Permalink to this definition">¶</a></dt>
<dd><p>RecipeResult documentation.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>master_twilightflat</td>
<td>(MasterTwilightFlat, product)</td>
</tr>
<tr class="row-even"><td>reduced_image</td>
<td>(ProcessedFrame, product)</td>
</tr>
<tr class="row-odd"><td>reduced_rss</td>
<td>(ProcessedRSS, product)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Twilight fiber-flat</a><ul>
<li><a class="reference internal" href="#requeriments">Requeriments</a></li>
<li><a class="reference internal" href="#procedure">Procedure</a></li>
<li><a class="reference internal" href="#products">Products</a></li>
<li><a class="reference internal" href="#recipe-inputs-and-results">Recipe, inputs and results</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fiberflat.html"
                        title="previous chapter">Fiber-flat</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bpm.html"
                        title="next chapter">Bad-pixels mask</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/calibration/twilight.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bpm.html" title="Bad-pixels mask"
             >next</a> |</li>
        <li class="right" >
          <a href="fiberflat.html" title="Fiber-flat"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MEGARA Data Reduction Pipeline 0.6.dev1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../modes.html" >Observing modes</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Calibration Modes</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2017, Universidad Complutense de Madrid.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>