Metadata-Version: 2.1
Name: aws-bunker
Version: 0.3.1
Summary: bunker is a command line program for setting up an ec2 in AWS for remote development or as a backup. It can clone your git repos, and transfer ignored files from your machine to the ec2.
Home-page: https://gitlab.com/shindagger/bunker
Author: Andy Klier, Gus Clemens
Author-email: andyklier@gmail.com
License: UNKNOWN
Platform: UNKNOWN
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Description-Content-Type: text/markdown
Requires-Dist: setuptools
Requires-Dist: boto3
Requires-Dist: inquirer

# bunker  

Bunker is a command line program for setting up an ec2 in AWS for remote development or as a backup. Among other things, it can clone your git repos and transfer ignored files from your machine to the ec2.

## requirements  

- python  
- aws cli  
- boto3  

Also, you will need an EC2 instance on AWS, preferably running ubuntu>=18.04. This EC2 will need ssh (port 22) open and an attached SSM role (AmazonEC2RoleforSSM).  

## installation  

`$ pip intall aws-bunker`  

NOTE: see shell scripts, and terraform sections below:  
PROJECT HOME PAGE: https://gitlab.com/shindagger/bunker  

### shell scripts  

the `install`, `extra`, and `prompt` subcommands assume there will be shell scripts on the EC2 called `install-essentials.sh`, `install-extras.sh`, and `.prompt.sh` respectively.  

the first two  shell scripts install essential software (like python, pip, node, and npm) and  extra software (like vncserver and gnome). `prompt` defines a PS1. `install-essentials.sh` and `install-extras.sh` should be executable (`chmod a+x`).  

See example scripts here (https://gitlab.com/shindagger/bunker) as well as the terraform section below:   

### terraform  

We have also included terraform files (https://gitlab.com/shindagger/bunker) which, when configured will spin up an EC2 instance you can use for bunker. terraform will output an instance ID you can use to init bunker with.  

To configure and use these terraform files:  

1. Clone this repo (https://gitlab.com/shindagger/bunker.git)  

2. cd into the repo dir and `ls *.default`. These are the files you will need to edit before you init terraform. Each one of these files will need the extention `.tf.default` changed to `.tf`.  

3. Edit `alfa.tf` and ensure that the region is correct.  

4. Edit `beta.tf` and change the s3 bucket to a bucket you own. Also ensure the region is correct.  

5. Edit `terraform.tfvars` with your AWS SDK access id and key. Also make sure you are configured to this account with `aws config`  

6. Edit `variables.tf` and change the default values to reflect your wishes. NOTE: if you don't have them already, you will need to create your own ssm role, and ssh key file manually. `ec2_key_name` is just the name of the keypair in AWS, while `ssh_private_key` is the full (absolute) path to your .pem file on your local machine.  

7. `terraform init`  

8. `terraform plan && terraform apply`  

### before you init bunker  

1. You have an EC2 instance ID. (see "terraform" above)  

2. You have a directory (prefix) in which you will keep `repositories.txt` and `ignoredfiles.txt`. You can copy sample files from this repo, and edit them to reflect your repos and ignored files.  

3. You have a .pem file and you know the path to its location.  

4. You know the username for the EC2 \(should be "ubuntu" by default\)  

## bunker usage  

`$ bunker -h`  

**Show main bunker help page and exit**  

`$ bunker build -h`  

**Show help page for the subcommand `build` and exit.** This will work with any available subcommand  

`$ bunker init`  

**Write the bunker config file `~/.config-bunker.ini`.** If the file exists already, answers will be populated with existing values \[_underlined_\], and only overwritten if you offer a replacement value.  

example `~/.config-bunker.ini`:
```
[default]  
prefix = /Users/username/bunker-config  
repos = repositories.txt   
ignored = ignoredfiles.txt  
pem = /Users/neolaura/somename.pem  
instance_id = i-04xxxxxxxxxxxx148  
username = ubuntu  
gitkeys = /Users/username/.ssh/git_rsa  
```  

`$ bunker install`  

**Install essential software on your EC2 instance.** This command will run an executable shell script on your EC2, specifically named `/home/ubuntu/install-essentials.sh`, intended to install any software essential to using your EC2. In an effort to stay agnostic about what software users want on their EC2, bunker does not install with included shell scripts. We do however provide example shell scripts \(as well as terraform for the EC2\) at the project homepage:  
https://gitlab.com/shindagger/bunker  

`$ bunker extra`  

**Install extra software on your EC2 instance.** Additionally, bunker has an `extra` subcommand which will run an executable shell script on your EC2, specifically named `/home/ubuntu/install-extras.sh`, intended to install any extra software you might want, that isn't essential \(ex: gnome, gimp, vnc\). In an effort to stay agnostic about what software users want on their EC2, bunker does not install with included shell scripts. We do however provide example shell scripts \(as well as terraform for the EC2\) at the project home page:  
https://gitlab.com/shindagger/bunker  

`$ bunker prompt`  

**Source a custom prompt file in `/home/ubuntu/.profile`.** This one is a little silly. This command will source a file, specifically named `/home/ubuntu/.prompt.sh`, in `/home/ubuntu/.profile`.    

`$ bunker build`  

**Clone list of git repos \(repositories.txt\) on your EC2 and then rsync list of ignored files \(ignoredfiles.txt\) from your local repos to the EC2 repos.** `git clone` will use ssh, assuming you have a public key setup at your git provider, a working `~/.ssh/config` tested at least once with `ssh -T git@PROVIDERURL`, and the associated private key set using `bunker init`.  



