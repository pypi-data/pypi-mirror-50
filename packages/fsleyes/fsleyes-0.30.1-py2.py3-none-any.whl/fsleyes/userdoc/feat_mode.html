

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Viewing FEAT analyses &mdash; FSLeyes 0.30.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IC classification" href="ic_classification.html" />
    <link rel="prev" title="Editing NIFTI images" href="editing_images.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> FSLeyes
          

          
          </a>

          
            
            
              <div class="version">
                0.30.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing FSLeyes</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="overlays.html">Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="ortho_lightbox_views.html">Orthographic/lightbox views</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_views.html">Plotting views</a></li>
<li class="toctree-l1"><a class="reference internal" href="3d_view.html">3D view</a></li>
<li class="toctree-l1"><a class="reference internal" href="atlases.html">Atlases</a></li>
<li class="toctree-l1"><a class="reference internal" href="editing_images.html">Editing NIFTI images</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Viewing FEAT analyses</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#loading-a-feat-analysis">Loading a FEAT analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-feat-layout">The FEAT layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="#viewing-clusters-the-cluster-panel">Viewing clusters (the cluster panel)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#viewing-model-fits-in-the-time-series-panel">Viewing model fits in the time series panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#glm-refresher">GLM refresher</a></li>
<li class="toctree-l2"><a class="reference internal" href="#understanding-feat-time-series-plots">Understanding FEAT time series plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#full-and-partial-model-fits">Full and partial model fits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reduced-data-plots">Reduced data plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ic_classification.html">IC classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="fsleyes_notebook.html">FSLeyes and Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="display_space.html">The display space</a></li>
<li class="toctree-l1"><a class="reference internal" href="customising.html">Customising FSLeyes</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">FSLeyes plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html"><code class="docutils literal notranslate"><span class="pre">fsleyes</span></code> release history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FSLeyes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Viewing FEAT analyses</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/feat_mode.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="viewing-feat-analyses">
<span id="feat-mode"></span><h1>Viewing FEAT analyses<a class="headerlink" href="#viewing-feat-analyses" title="Permalink to this headline">¶</a></h1>
<p>FSLeyes has some features which can help you to view and explore the results
of your <a class="reference external" href="http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT">FEAT</a> analyses.</p>
<div class="section" id="loading-a-feat-analysis">
<span id="feat-mode-loading-a-feat-analysis"></span><h2>Loading a FEAT analysis<a class="headerlink" href="#loading-a-feat-analysis" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
<p class="sidebar-title">What does a FEAT analysis directory look like?</p>
<p>FSLeyes detects FEAT directories based on the following rules.
If any of these rules are not met, FSLeyes will not recognise
your data as a FEAT analysis:</p>
<ul class="simple">
<li><p>The directory name must end in <code class="docutils literal notranslate"><span class="pre">.feat</span></code></p></li>
<li><p>The directory must contain the following files:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filtered_func_data</span></code>: a NIFTI image containing the
pre-processed input data (the file extension does not
matter)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">design.fsf</span></code>: FEAT configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">design.mat</span></code>: FEAT design matrix file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">design.con</span></code>: FEAT contrast vector file</p></li>
</ul>
</div></blockquote>
</div>
<p>You can load a FEAT analysis in a few different ways <a class="footnote-reference brackets" href="#id2" id="id1">*</a>:</p>
<ul>
<li><p>From the <a class="reference internal" href="command_line.html#command-line"><span class="std std-ref">command line</span></a> - you can specify either a
<code class="docutils literal notranslate"><span class="pre">.feat</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fsleyes</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my_analysis</span><span class="o">.</span><span class="n">feat</span>
</pre></div>
</div>
<p>Or the <code class="docutils literal notranslate"><span class="pre">filtered_func_data</span></code> image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fsleyes</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my_analysis</span><span class="o">.</span><span class="n">feat</span><span class="o">/</span><span class="n">filtered_func_data</span>
</pre></div>
</div>
</li>
<li><p>Via <em>File</em> ⇒ <em>Add from directory</em> - select your
<code class="docutils literal notranslate"><span class="pre">.feat</span></code> analysis directory.</p></li>
<li><p>Via <em>File</em> ⇒ <em>Add from file</em> - select the
<code class="docutils literal notranslate"><span class="pre">filtered_func_data</span></code> image located in your <code class="docutils literal notranslate"><span class="pre">.feat</span></code> analysis directory.</p></li>
</ul>
<p>In fact, you can load any NIFTI image contained within a <code class="docutils literal notranslate"><span class="pre">.feat</span></code> analysis
directory - FSLeyes will automatically detect that the image is part of a FEAT
analysis. However, the <code class="docutils literal notranslate"><span class="pre">filtered_func_data</span></code> image must be loaded in order to
view <a class="reference internal" href="#feat-mode-viewing-model-fits-in-the-time-series-panel"><span class="std std-ref">time series and model fits</span></a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">*</a></span></dt>
<dd><p>FSLeyes 0.30.1 does not contain any special functionality for
higher-level FEAT analyses (<code class="docutils literal notranslate"><span class="pre">.gfeat</span></code> directories). But you can load
and view the individual <code class="docutils literal notranslate"><span class="pre">cope*.feat</span></code> directories contained within a
<code class="docutils literal notranslate"><span class="pre">.gfeat</span></code> directory. Future versions of FSLeyes will add
functionality for working with group analyses.</p>
</dd>
</dl>
</div>
<div class="section" id="the-feat-layout">
<span id="feat-mode-the-feat-layout"></span><h2>The FEAT layout<a class="headerlink" href="#the-feat-layout" title="Permalink to this headline">¶</a></h2>
<p>The FEAT layout arranges the FSLeyes interface for viewing FEAT analyses.</p>
<a class="reference internal image-reference" href="_images/feat_mode_feat_perspective.png"><img alt="_images/feat_mode_feat_perspective.png" class="align-center" src="_images/feat_mode_feat_perspective.png" style="width: 75%;" /></a>
<p>The FEAT layout simply adds a <a class="reference internal" href="#feat-mode-viewing-clusters-the-cluster-panel"><span class="std std-ref">cluster panel</span></a>, and a <a class="reference internal" href="#feat-mode-viewing-model-fits-in-the-time-series-panel"><span class="std std-ref">time series panel</span></a> to the <a class="reference internal" href="overview.html#overview-default-layout"><span class="std std-ref">default
layout</span></a>.</p>
<p>You can activate the FEAT layout via the <em>View</em> ⇒
<em>Layouts</em> ⇒ <em>FEAT mode</em> menu item. Or you can tell FSLeyes to
start up with the FEAT layout via the <a class="reference internal" href="command_line.html#command-line"><span class="std std-ref">command line</span></a>
(the <code class="docutils literal notranslate"><span class="pre">-s</span></code> flag is short for <code class="docutils literal notranslate"><span class="pre">--scene</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fsleyes</span> <span class="o">-</span><span class="n">s</span> <span class="n">feat</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my_analysis</span><span class="o">.</span><span class="n">feat</span>
</pre></div>
</div>
</div>
<div class="section" id="viewing-clusters-the-cluster-panel">
<span id="feat-mode-viewing-clusters-the-cluster-panel"></span><h2>Viewing clusters (the cluster panel)<a class="headerlink" href="#viewing-clusters-the-cluster-panel" title="Permalink to this headline">¶</a></h2>
<p>If you have used <a class="reference external" href="http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FEAT/UserGuide">cluster thresholding</a> in your FEAT
analysis, the cluster panel allows you to browse the clusters that were found
in each contrast of your analysis.</p>
<a class="reference internal image-reference" href="_images/feat_mode_cluster_panel.png"><img alt="_images/feat_mode_cluster_panel.png" class="align-center" src="_images/feat_mode_cluster_panel.png" style="width: 80%;" /></a>
<p>The controls at the top of the cluster panel allow you to:</p>
<ul class="simple">
<li><p>Change the contrast that you are viewing cluster results for.</p></li>
<li><p>Load the Z statistic image for the current contrast. The image is displayed
as a <a class="reference internal" href="overlays.html#overlays-volume"><span class="std std-ref">volume overlay</span></a>.</p></li>
<li><p>Load a cluster mask image for the current contrast. The image is displayed
as a <a class="reference internal" href="overlays.html#overlays-label"><span class="std std-ref">label overlay</span></a>, highlighting the clusters that
were deemed significant for this contrast.</p></li>
</ul>
<p>The table in the cluster panel lists all of the clusters that were found to be
significant for the current contrast. The information shown in this table is
similar to that which can be generated with the <a class="reference external" href="http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Cluster">FSL <code class="docutils literal notranslate"><span class="pre">cluster</span></code> tool</a>.  The
→ buttons embedded in the table allow you to move the display to
the following locations for a given cluster:</p>
<blockquote>
<div><ul class="simple">
<li><p>The location of the maximum Z value in the cluster</p></li>
<li><p>The location of the clutser’s centre of gravity</p></li>
<li><p>The location of the maximum COPE value in the cluster</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="viewing-model-fits-in-the-time-series-panel">
<span id="feat-mode-viewing-model-fits-in-the-time-series-panel"></span><h2>Viewing model fits in the time series panel<a class="headerlink" href="#viewing-model-fits-in-the-time-series-panel" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="plot_views.html#plot-views-time-series-view"><span class="std std-ref">time series view</span></a> contains
functionality specific to FEAT analyses. When the selected overlay is from a
FEAT analysis (and the <code class="docutils literal notranslate"><span class="pre">filtered_func_data</span></code> image from that analysis is
loaded), the time series view will plot the time series for the current voxel,
and will also plot the full GLM model fit for that voxel. You can also plot
several other types of data from a FEAT analysis, including explanatory
variables (EVs), parameter estimates (PEs) and contrasts of parameter
estimates (COPEs).</p>
<p>When an image from a FEAT analysis is selected, the <a class="reference internal" href="plot_views.html#plot-views-customising-the-plot-the-plot-control-panel"><span class="std std-ref">plot control panel</span></a> adds a group of
settings allowing you to control what is plotted. See the <a class="reference internal" href="#feat-mode-glm-refresher"><span class="std std-ref">GLM refresher</span></a> below for more details on what the options mean:</p>
<a class="reference internal image-reference" href="_images/feat_mode_time_series_feat_settings.png"><img alt="_images/feat_mode_time_series_feat_settings.png" class="align-center" src="_images/feat_mode_time_series_feat_settings.png" style="width: 60%;" /></a>
<ul class="simple">
<li><p><strong>Plot data</strong> This setting is selected by default. When selected, the input
data for the current voxel is plotted.</p></li>
<li><p><strong>Plot full model fit</strong> This setting is selected by default. When selected,
the full model fit at the current voxel is plotted.</p></li>
<li><p><strong>Plot residuals</strong> When selected, the residuals of the full model fit (the
noise) at the current voxel is plotted.</p></li>
<li><p><strong>Plot reduced data against</strong> This setting allows you to plot a “reduced”
version of the data at the current voxel, against any of the PEs or COPEs in
the analysis.</p></li>
<li><p><strong>Plot EV</strong> A checkbox is added for each EV in your design, allowing you to
plot them alongside the data.</p></li>
<li><p><strong>Plot PE fit</strong> A checkbox is added for each PE in the analysis, allowing
you to plot the model fit for any of them at the current voxel.</p></li>
<li><p><strong>Plot COPE fit</strong> A checkbox is added for each COPE in the analysis,
allowing you to plot the model fit for any of them at the current voxel.</p></li>
</ul>
</div>
<div class="section" id="glm-refresher">
<span id="feat-mode-glm-refresher"></span><h2>GLM refresher<a class="headerlink" href="#glm-refresher" title="Permalink to this headline">¶</a></h2>
<p><cite>The following overview pertains to fitting a model to the time course for a
single voxel.</cite></p>
<p>Let’s say that we have an experimental model comprising a single <em>explanatory
variable</em> (EV).  For a voxel with an observed time course
<span class="math notranslate nohighlight">\(\boldsymbol{Y}\)</span>, over <span class="math notranslate nohighlight">\(n\)</span> time points:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{Y} = {Y_1, Y_2, \dots, Y_n}\]</div>
<p>And an expected time course <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> (the time course of our
EV):</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{X} = {X_1, X_2, \dots, X_n}\]</div>
<p>The aim of the General Linear Model (GLM) is to obtain the best fit of
<span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> to <span class="math notranslate nohighlight">\(\boldsymbol{Y}\)</span>, by finding the best values
for the <em>parameter estimates</em> (PEs) <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> in the
following equation:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{Y} = \boldsymbol{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}\]</div>
<p>This is equivalent to finding the minimum value for the residual error
<span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span>.</p>
<p>With a single EV (i.e. <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> is a column vector), we end up
with a single PE <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span>. With <span class="math notranslate nohighlight">\(p\)</span> EVs
(i.e. <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> is a <span class="math notranslate nohighlight">\(p\times n\)</span> matrix),
<span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> will be a vector of PEs, one for each EV:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\beta} = {\beta_1, \beta_2, \dots, \beta_p}\]</div>
<p>A <em>contrast of parameter estimates</em> (COPE) is simply a linear combination of
PEs, and is defined with a contrast vector. Let’s say our experimental design
comprises three EVs (i.e. <span class="math notranslate nohighlight">\(p = 3\)</span> in the above equations), and we are
interested in the first. The contrast vector (or simply the contrast) would
be:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{C_1} = {1, 0, 0}\]</div>
<p>The COPE for this contrast is then the elementwise product of the contrast
vector <span class="math notranslate nohighlight">\(\boldsymbol{C}\)</span> and the parameter estimates
<span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}COPE_1 &amp;= 1 \times \beta_1 + 0 \times \beta_2 + 0 \times \beta_3 \\
       &amp;= \beta_1\end{split}\]</div>
</div>
<div class="section" id="understanding-feat-time-series-plots">
<span id="feat-mode-understanding-feat-time-series-plots"></span><h2>Understanding FEAT time series plots<a class="headerlink" href="#understanding-feat-time-series-plots" title="Permalink to this headline">¶</a></h2>
<p>With the above <a class="reference internal" href="#feat-mode-glm-refresher"><span class="std std-ref">refresher</span></a>, we can now describe
what FSLeyes plots, when you view the results of a FEAT analysis. A few of the
options are straightforward to interpret:</p>
<ul class="simple">
<li><p><strong>Plot data</strong> This option plots the voxel time course
<span class="math notranslate nohighlight">\(\boldsymbol{Y}\)</span>.</p></li>
<li><p><strong>Plot residutals</strong> This option plots the residual error
<span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span>.</p></li>
<li><p><strong>Plot EV</strong> These options plot the EVs, i.e. the columns of
<span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span>.</p></li>
</ul>
<div class="sidebar">
<p class="sidebar-title">The FSLeyes plots don’t match the FEAT report plots!</p>
<p>The plots included in FEAT reports are generated by the
<code class="docutils literal notranslate"><span class="pre">tsplot</span></code> command line utility. While FSLeyes 0.30.1 and
<code class="docutils literal notranslate"><span class="pre">tsplot</span></code> essentially plot the same data, <code class="docutils literal notranslate"><span class="pre">tsplot</span></code> may apply
some further processing to the full and partial model fits,
including weighting them by Z values, and
pre-whitening. Furthermore, in FSL 5.0.10, <code class="docutils literal notranslate"><span class="pre">tsplot</span></code>
handles contrast vectors with negative values in a strange
manner, resulting in partial model fits being plotted upside-down
with respect to the fitted data.  Therefore plots shown in
FSLeyes 0.30.1 may not exactly match the corresponding plots
in the FEAT report.</p>
</div>
<div class="section" id="full-and-partial-model-fits">
<span id="feat-mode-full-and-partial-model-fits"></span><h3>Full and partial model fits<a class="headerlink" href="#full-and-partial-model-fits" title="Permalink to this headline">¶</a></h3>
<p>The <em>Plot full model fit</em>, <em>Plot PE fit</em> and <em>Plot COPE fit</em> options all work
in a similar manner, so are described together. Each of these options plot the
GLM model fit for a specific contrast vector.</p>
<p>For a contrast <span class="math notranslate nohighlight">\(\boldsymbol{C}\)</span>, the model fit <span class="math notranslate nohighlight">\(\boldsymbol{F_C}\)</span>
at time <span class="math notranslate nohighlight">\(t\)</span> is calculated as:</p>
<div class="math notranslate nohighlight">
\[F_C^t = \sum_{e=1}^{p}{X_e^t\ \beta_e\ |C_e|}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the number of EVs in the design matrix,</p></li>
<li><p><span class="math notranslate nohighlight">\(X_e^t\)</span> is the value in the design matrix for EV <span class="math notranslate nohighlight">\(e\)</span> at time
<span class="math notranslate nohighlight">\(t\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_e\)</span> is the parameter estimate for EV <span class="math notranslate nohighlight">\(e\)</span>, and</p></li>
<li><p><span class="math notranslate nohighlight">\(|C_e|\)</span> is the absolute value in the contrast vector for EV <span class="math notranslate nohighlight">\(e\)</span>.
The absolute value is used because the parameter estimate <span class="math notranslate nohighlight">\(\beta_e\)</span>
should already have an appropriate sign.</p></li>
</ul>
<p>The contrast vector <span class="math notranslate nohighlight">\(\boldsymbol{C}\)</span> is defined as follows:</p>
<ul class="simple">
<li><p>For the <em>Plot full model fit</em> option, the contrast <span class="math notranslate nohighlight">\(\boldsymbol{C}\)</span>
is simply a vector of ones.</p></li>
<li><p>For the <em>Plot PE fit</em> options, <span class="math notranslate nohighlight">\(\boldsymbol{C}\)</span> is a vector
containing a one for the EV corresponding to the PE, and zeros everywhere
else.</p></li>
<li><p>For the <em>Plot COPE fit</em> options, the contrast is the contrast vector that
was used in the FEAT analysis.</p></li>
</ul>
<p>A few further steps are applied to the above process:</p>
<ul>
<li><p>The contrast vectors are normalised before the model fit is calculated:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{C} = \frac{\sqrt{n_\boldsymbol{C}}\boldsymbol{C}}{\sqrt{\sum_{e=1}^{p}{C_e^2}}}\]</div>
<p>where <span class="math notranslate nohighlight">\(n_\boldsymbol{C}\)</span> is the number of non-zero elements in the
contrast vector.  This normalisation is applied purely for display purposes,
so that partial model fits are scaled in a sensible manner.</p>
</li>
<li><p>If the analysis is a first-level analysis (i.e. fitting a model to time
series data), the data mean is added to the model fit. This is because FEAT
de-means time series data before calculating the model fit.</p></li>
</ul>
</div>
<div class="section" id="reduced-data-plots">
<span id="feat-mode-reduced-data-plots"></span><h3>Reduced data plots<a class="headerlink" href="#reduced-data-plots" title="Permalink to this headline">¶</a></h3>
<p>The <em>Plot reduced data against</em> option allows you to plot a “reduced” version
of the voxel time course against any of the PEs or COPEs in your analysis. The
reduced data <span class="math notranslate nohighlight">\(\boldsymbol{D}\)</span> for a contrast <span class="math notranslate nohighlight">\(\boldsymbol{C}\)</span> is
easily calculated:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{D_C} = \boldsymbol{F_C} + \boldsymbol{\epsilon}\]</div>
<p>i.e. the reduced data for a contrast is the sum of the partial model fit for
that contrast, and the residual error from the GLM estimation.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ic_classification.html" class="btn btn-neutral float-right" title="IC classification" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="editing_images.html" class="btn btn-neutral float-left" title="Editing NIFTI images" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Paul McCarthy, University of Oxford, Oxford, UK

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>